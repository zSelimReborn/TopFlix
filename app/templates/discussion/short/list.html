<ul class="discussion-list title-{{t.id|string()}}">
    {% for discussion in t.discussions() %}
        {% if not discussion.is_answer %}
        <li class="discussion-wrapper">
            <div class="discussion-actions">
                {% if discussion.is_author(current_user) %}
                    <div class="remove-wrapper">
                        <a href="{{ url_for('main.remove_discussion', discussion_id=discussion.id|string) }}" class="btn btn-link remove-discussion">
                            <span class="material-icons">cancel</span>
                        </a>
                    </div>
                    <div class="edit-wrapper">
                        <a href="{{ url_for('main.edit_discussion', discussion_id=discussion.id|string) }}" class="btn btn-link edit-discussion">
                            <span class="material-icons">edit</span>
                        </a>
                    </div>
                {% endif %}
            </div>
            <div class="upvotes-wrapper">
                {% with d = discussion %}
                {% include "discussion/upvotes.html" %}
                {% endwith %}
            </div>
            <div class="discussion-short">
                {% include "discussion/short/view.html" %}
            </div>
            <div class="discussion-full hidden">
                {% include "discussion/view.html" %}
            </div>
        </li>
        {% endif %}
    {% endfor %}
</ul>

<script type="text/javascript">
    $(function() {
        $(".view-discussion").on("click", function(e) {
            let btn = $(this);
            let wrapper = btn.closest(".discussion-wrapper");
            let wrapperList = wrapper.closest(".discussion-list");
            
            wrapperList.addClass("view-full");
            wrapper.addClass("view-full");

            wrapper.find(".discussion-full").removeClass("hidden");
            wrapper.find(".discussion-short").addClass("hidden");
        });

        $(".back-discussion").on("click", function(e) {
            let btn = $(this);
            let wrapper = btn.closest(".discussion-wrapper");
            let wrapperList = wrapper.closest(".discussion-list");
            
            wrapperList.removeClass("view-full");
            wrapper.removeClass("view-full");

            wrapper.find(".discussion-full").addClass("hidden");
            wrapper.find(".discussion-short").removeClass("hidden");
        });
    });
</script>
